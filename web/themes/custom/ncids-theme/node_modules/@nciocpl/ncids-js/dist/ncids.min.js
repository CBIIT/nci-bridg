var e=window&&window.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,a){function o(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))};class t{constructor(e,i){if(this.optionsListNumber=null,this.optionClickEventListener=e=>this.handleOptionClick(e),this.inputEventListener=()=>this.handleInput(),this.keyPressEventListener=e=>this.handleKeypress(e),this.submissionEventListener=()=>this.handleFormSubmission(),this.outsideClickListener=e=>this.handleOutsideClick(e),this.autocompleteInput=e,this.autocompleteInputId=this.autocompleteInput.id,this.options=Object.assign(Object.assign({autocompleteSource:void 0},t.optionDefaults),i),!this.options.autocompleteSource)throw"option autocompleteSource is undefined";for(this.optionsListDisplayed=!1,this.selectedOptionInfo={inputtedTextWhenSelected:"",selectedOptionIndex:null,selectedOptionValue:null},this.adaptor=this.options.autocompleteSource,this.acForm=this.autocompleteInput.closest("form"),this.acInputParent=this.autocompleteInput.parentElement,this.autocompleteContainer=document.createElement("div"),this.autocompleteContainer.classList.add("nci-autocomplete");this.acInputParent.firstChild;){const e=this.acInputParent.firstChild;this.acInputParent.removeChild(this.acInputParent.firstChild),this.autocompleteContainer.appendChild(e)}this.acInputParent.append(this.autocompleteContainer),this.listboxWrapper=document.createElement("div"),this.listbox=document.createElement("div"),this.announcer=document.createElement("div"),this.initialize()}static create(e,t){if(!(e instanceof HTMLInputElement))throw"Must be an input element to be an autocomplete";return new this(e,t)}initialize(){this.updateDom()}updateDom(){this.listboxWrapper.setAttribute("id",this.autocompleteInputId+"-termswrapper"),this.listboxWrapper.classList.add("nci-autocomplete__listbox"),""!==this.options.listboxClasses&&this.listboxWrapper.classList.add(this.options.listboxClasses),this.listbox.setAttribute("id",this.autocompleteInputId+"-terms"),this.listbox.setAttribute("tabindex","-1"),this.listbox.setAttribute("role","listbox"),this.listboxWrapper.append(this.listbox),this.autocompleteContainer.append(this.listboxWrapper),this.announcer.classList.add("nci-autocomplete__status"),this.announcer.setAttribute("aria-live","assertive"),this.autocompleteContainer.prepend(this.announcer),this.autocompleteInput.setAttribute("role","combobox"),this.autocompleteInput.setAttribute("aria-autocomplete","list"),this.autocompleteInput.setAttribute("aria-haspopup","listbox"),this.autocompleteInput.setAttribute("aria-expanded","false"),this.autocompleteInput.setAttribute("aria-owns",this.autocompleteInputId+"-terms"),this.autocompleteInput.setAttribute("aria-activedescendant",""),this.addEventListeners()}addEventListeners(){this.autocompleteInput.addEventListener("input",this.inputEventListener,!0),this.autocompleteInput.addEventListener("keydown",this.keyPressEventListener,!0),this.acForm.addEventListener("submit",this.submissionEventListener,!0),window.addEventListener("click",this.outsideClickListener,!0)}closeListbox(){this.autocompleteInput.removeAttribute("aria-activedescendant"),this.autocompleteInput.setAttribute("aria-expanded","false"),this.announcer.innerHTML="",this.listbox.innerHTML="",this.listboxWrapper.classList.remove("active")}handleFormSubmission(){const e=Object.assign({searchText:this.autocompleteInput.value,optionsPresented:this.optionsListDisplayed,optionSetSize:this.optionsListNumber},this.selectedOptionInfo);this.autocompleteInput.dispatchEvent(new CustomEvent("nci-autocomplete:formSubmission",{bubbles:!0,detail:e})),this.selectedOptionInfo={inputtedTextWhenSelected:"",selectedOptionIndex:null,selectedOptionValue:null}}handleInput(){return e(this,void 0,void 0,(function*(){if(this.autocompleteInput.value.length>=this.options.minCharCount){const e=yield this.adaptor.getAutocompleteSuggestions(this.autocompleteInput.value);this.buildTermsList(e)}else this.options.minPlaceholderMsg&&this.autocompleteInput.value.length<this.options.minCharCount&&this.autocompleteInput.value.length>0?(this.optionsListDisplayed=!1,this.listbox.innerHTML=`<div class="nci-autocomplete__option"><span class="minPlaceholderMsg">${this.options.minPlaceholderMsg}</span></div>`,this.listboxWrapper.classList.add("active")):(this.optionsListDisplayed=!1,this.closeListbox())}))}handleOutsideClick(e){if(this.listboxWrapper.classList.contains("active")){e.target.matches("nci-autocomplete__option")||this.closeListbox()}}handleKeypress(e){var t;const i=e,s=(null===(t=this.listbox.querySelectorAll(".highlight"))||void 0===t?void 0:t.length)>0;switch(i.key){case"Escape":case"Tab":this.closeListbox();break;case"Enter":return s?(e.preventDefault(),e.stopPropagation(),this.selectOption(s)):void 0;case"ArrowRight":return this.selectOption(s);case"ArrowUp":return e.preventDefault(),e.stopPropagation(),this.moveUp(s);case"ArrowDown":return e.preventDefault(),e.stopPropagation(),this.moveDown(s);default:return}}moveUp(e){if(e){const e=this.listbox.querySelector(".highlight");e.setAttribute("aria-selected","false"),e.classList.remove("highlight");const t=e.previousSibling;t.setAttribute("aria-selected","true"),t.classList.add("highlight"),this.autocompleteInput.setAttribute("aria-activedescendant",t.id)}else{const e=this.listbox.querySelectorAll(".nci-autocomplete__option"),t=e[e.length-1];null!=t&&(t.classList.add("highlight"),t.setAttribute("aria-selected","true"),this.autocompleteInput.setAttribute("aria-activedescendant",t.id))}}moveDown(e){if(e){const e=this.listbox.querySelector(".highlight");e.setAttribute("aria-selected","false"),e.classList.remove("highlight");const t=e.nextSibling;t.setAttribute("aria-selected","true"),t.classList.add("highlight"),this.autocompleteInput.setAttribute("aria-activedescendant",t.id)}else{const e=this.listbox.querySelectorAll(".nci-autocomplete__option")[0];e.classList.add("highlight"),e.setAttribute("aria-selected","true"),this.autocompleteInput.setAttribute("aria-activedescendant",e.id)}}selectOption(e){if(e&&this.autocompleteInput){const e=this.listbox.querySelector(".highlight"),t=null==e?void 0:e.querySelector("span");this.selectedOptionInfo={inputtedTextWhenSelected:this.autocompleteInput.value,selectedOptionValue:t.getAttribute("aria-label")||"",selectedOptionIndex:Number(e.getAttribute("aria-posinset")||"")||0},this.autocompleteInput.dispatchEvent(new CustomEvent("nci-autocomplete:optionSelected",{detail:this.selectedOptionInfo})),this.autocompleteInput.removeAttribute("aria-activedescendant"),this.autocompleteInput.value=t.getAttribute("aria-label")||"",this.autocompleteInput.focus(),this.closeListbox()}}markInputMatch(e){return e.replace(new RegExp(this.autocompleteInput.value,"gi"),(e=>`<mark>${e}</mark>`))}buildTermsList(e){if(this.updateAnnouncer(e.length),e.length<1)this.optionsListDisplayed=!1,this.listbox.innerHTML="",this.listboxWrapper.classList.remove("active"),this.optionsListNumber=0,this.closeListbox();else{const t=e.map(((t,i)=>(this.optionsListNumber=e.length,i<this.options.maxOptionsCount?`<div \n            class="nci-autocomplete__option" \n            tabindex="-1" \n            role="option" \n            aria-posinset="${i}" \n            aria-setsize="${e.length}" \n            id="term-${i}">\n              <span aria-label="${t}">${this.options.highlightMatchingText?this.markInputMatch(t):t}</span>\n            </div>`:"")));this.listbox.innerHTML=t.join(""),this.listboxWrapper.classList.add("active"),this.autocompleteInput.setAttribute("aria-expanded","true"),this.optionsListDisplayed=!0;document.querySelectorAll(`#${this.autocompleteInputId}-terms .nci-autocomplete__option`).forEach((e=>{e.addEventListener("click",this.optionClickEventListener,!0)}))}}handleOptionClick(e){const t=e.currentTarget,i=t.querySelector("span").getAttribute("aria-label")||"";this.selectedOptionInfo={inputtedTextWhenSelected:this.autocompleteInput.value,selectedOptionValue:i,selectedOptionIndex:Number(t.getAttribute("aria-posinset"))},this.autocompleteInput.dispatchEvent(new CustomEvent("nci-autocomplete:optionSelected",{detail:this.selectedOptionInfo})),this.autocompleteInput.value=i,this.autocompleteInput.focus(),this.closeListbox()}updateAnnouncer(e){this.announcer.innerHTML=e>=1?"es"===document.documentElement.lang?`${e.toString()} sugerencias automáticas. Use flecha arriba o flecha abajo para escuchar las opciones.`:`${e.toString()} suggestions found, use up and down arrows to review`:""}}t.optionDefaults={highlightMatchingText:!0,maxOptionsCount:10,minCharCount:3,minPlaceholderMsg:"",listboxClasses:"",optionSetSize:null};class i{constructor(e,t){this.customEvents={},this.clickEventListener=()=>this.handleClick(),this.element=e,this.options=t,this.collapseHeader=document.createElement("button"),this.heading=this.element.querySelector(`.${this.options.collapseButtonClass}`),this.list=this.element.querySelector(".usa-list--unstyled"),this.listHeader=document.createElement("span"),this.initialize()}unregister(){this.element.classList.remove("hidden"),this.toggleCollapseA11y(!1);const e=this.collapseHeader.innerHTML;this.collapseHeader.remove(),this.listHeader.remove(),this.list.removeAttribute("id"),this.list.removeAttribute("aria-label"),this.heading.classList.add(this.options.collapseButtonClass),this.heading.innerHTML=e,this.removeEventListeners()}initialize(){this.createCustomEvents(),this.addEventListeners(),this.updateDom(),this.toggleCollapse(!0)}updateDom(){const e=this.heading.innerHTML,t=e.replace(/ /g,"-").toLowerCase();this.heading.classList.remove(this.options.collapseButtonClass),this.heading.innerHTML="",this.listHeader.classList.add(this.options.collapseButtonClass,"usa-footer__nci-list-header"),this.listHeader.innerHTML=e,this.collapseHeader.classList.add(this.options.collapseButtonClass,"usa-footer__nci-collapse-header"),this.collapseHeader.setAttribute("aria-controls",t),this.collapseHeader.setAttribute("aria-expanded","false"),this.collapseHeader.innerHTML=e,this.list.setAttribute("id",t),this.list.setAttribute("aria-label",e),this.heading.append(this.listHeader),this.heading.append(this.collapseHeader)}toggleCollapse(e){this.element.querySelector(".usa-list").classList.toggle("hidden",e),this.toggleCollapseA11y(e);const t=e?"collapse":"expand";this.element.dispatchEvent(this.customEvents[t])}toggleCollapseA11y(e){this.collapseHeader.setAttribute("aria-expanded",String(!e)),this.list.setAttribute("aria-hidden",String(e)),this.list.hidden=e,this.list.hidden=e}addEventListeners(){this.collapseHeader.addEventListener("click",this.clickEventListener)}removeEventListeners(){this.collapseHeader.removeEventListener("click",this.clickEventListener)}handleClick(){this.element.querySelector(".usa-list").classList.contains("hidden")?this.toggleCollapse(!1):this.toggleCollapse(!0)}createCustomEvents(){["collapse","expand"].forEach((e=>{this.customEvents[e]=new CustomEvent(`${this.options.collapseEventListenerLabel}:${e}`,{bubbles:!0,detail:this.element})}))}}class s{constructor(e){this.scrollListener=()=>this.handleScroll(),this.element=e,this.initialize()}handleScroll(){window.scrollY>0?(this.element.classList.remove("hide"),this.element.classList.add("show")):(this.element.classList.remove("show"),this.element.classList.add("hide"))}unregister(){this.element.classList.remove("show","hide","usa-footer__nci-return-to-top"),this.element.classList.add("grid-container","usa-footer__return-to-top")}initialize(){this.element.classList.remove("grid-container","usa-footer__return-to-top"),this.element.classList.add("usa-footer__nci-return-to-top","hide"),window.addEventListener("scroll",this.scrollListener,!1)}}class n{constructor(e,t){this.customEvents={},this.submitEventListener=e=>this.handleSubmit(e),this.form=e,this.options=t,this.invalidEmailAlert=this.createInvalidEmailAlert();const i=n._components.get(this.form);i&&i.unregister(),n._components.set(this.form,this),this.initialize()}static create(e,t){if(!(e instanceof HTMLElement))throw"Element is not an HTMLElement";return this._components.get(e)||new this(e,t)}unregister(){this.removeEventListeners(),this.toggleFormErrors(!0),this.invalidEmailAlert.remove(),n._components.delete(this.form)}initialize(){this.addEventListeners(),this.createCustomEvents(),this.addMessage()}addEventListeners(){this.form.addEventListener("submit",this.submitEventListener)}removeEventListeners(){this.form.removeEventListener("submit",this.submitEventListener)}handleSubmit(e){e.preventDefault();const t=this.form,i=t.elements.namedItem("email");/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(i.value)?(this.toggleFormErrors(!0),this.form.dispatchEvent(this.customEvents.submit),t.submit()):(this.toggleFormErrors(!1),this.form.dispatchEvent(this.customEvents.error),i.focus())}createInvalidEmailAlert(){const e=document.createElement("span");return e.classList.add("usa-error-message","hidden"),e.id="email-error-message",e.innerHTML=this.options.subscribeInvalidEmailAlert,e.setAttribute("aria-hidden",String(!0)),e.setAttribute("role","alert"),e}addMessage(){const e=this.form.querySelector(".usa-input");e.setAttribute("aria-describedby",this.invalidEmailAlert.id),e.before(this.invalidEmailAlert)}toggleFormErrors(e){const t=this.form.querySelector(".usa-form-group");e?t.classList.remove("usa-form-group--error"):t.classList.add("usa-form-group--error");const i=this.form.querySelector(".usa-label");e?i.classList.remove("usa-label--error"):i.classList.add("usa-label--error");const s=this.form.querySelector(".usa-input");e?s.classList.remove("usa-input--error"):s.classList.add("usa-input--error");const n=this.form.querySelector(".usa-error-message");e?n.classList.add("hidden"):n.classList.remove("hidden"),n.setAttribute("aria-hidden",String(e))}createCustomEvents(){["submit","error"].forEach((e=>{this.customEvents[e]=new CustomEvent(`${this.options.subscribeEventListenerLabel}:${e}`,{detail:this.form})}))}}n._components=new Map;class a{constructor(e,t){this.collapses=[],this.resizeEventListener=e=>this.handleResize(e),this.element=e,this.options=Object.assign(Object.assign({},a.optionDefaults),t),this.collapseMediaQuery=matchMedia(`(min-width: ${this.options.collapseWidth}px)`);const i=a._components.get(this.element);i&&i.unregister(),a._components.set(this.element,this),this.initialize()}static create(e,t){if(!(e instanceof HTMLElement))throw"Element is not an HTMLElement";return this._components.get(e)||new this(e,t)}static autoInit(){document.addEventListener("DOMContentLoaded",(()=>{Array.from(document.getElementsByClassName("usa-footer")).forEach((e=>{this.create(e)}))}))}unregister(){this.form&&(this.form.unregister(),this.form=void 0),this.backToTop&&(this.backToTop.unregister(),this.backToTop=void 0),this.unregisterCollapses(),this.removeEventListeners(),a._components.delete(this.element)}unregisterCollapses(){this.collapses.forEach((e=>{e.unregister()})),this.collapses=[]}initialize(){this.createSubscribe(),this.addEventListeners(),this.createBackToTop();window.innerWidth<this.options.collapseWidth&&this.createCollapsibleSections()}handleResize(e){e.matches?this.unregisterCollapses():this.createCollapsibleSections()}createCollapsibleSections(){this.queryCollapsibleSections().forEach(((e,t)=>{this.collapses[t]=new i(e,this.options)}))}queryCollapsibleSections(){return Array.from(this.element.querySelectorAll(".usa-footer__primary-content--collapsible"))}createSubscribe(){const e=this.element.querySelector("form");e&&(this.form=n.create(e,this.options))}createBackToTop(){const e=this.element.getElementsByClassName("usa-footer__return-to-top")[0];e&&(this.backToTop=new s(e))}addEventListeners(){this.collapseMediaQuery.addEventListener("change",this.resizeEventListener)}removeEventListeners(){this.collapseMediaQuery.removeEventListener("change",this.resizeEventListener)}}a.optionDefaults={collapseButtonClass:"usa-footer__primary-link",collapseClass:"usa-footer__primary-content--collapsible",collapseWidth:480,collapseEventListenerLabel:"usa-footer:nav-links",subscribeInvalidEmailAlert:"Enter a valid email address",subscribeEventListenerLabel:"usa-footer:sign-up"},a._components=new Map;class o{constructor(e,t){this.customEvents={},this.eventListener=()=>this.handleClose(),this.element=e,this.options=t,this.button=this.createButton(),this.initialize()}unregister(){this.removeEventListeners(),this.element.style.display="",this.button.remove()}initialize(){this.hideSiteAlert(),this.createCustomEvents(),this.addButton(),this.addEventListeners()}createButton(){const e=document.createElement("button");return e.classList.add("usa-alert__nci-button",this.options.closeButtonClass),e.setAttribute("aria-label",this.options.closeAriaLabel),e.innerHTML+='<svg class="usa-icon" role="img" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M0 13.0332964L13.0332964 0M13.0332964 13.0332964L0 0" transform="translate(1 1)"/></svg>',e}hideSiteAlert(){var e;"hidden"===(null===(e=document.cookie.match(`(^|;)\\s*NCISiteAlert${this.element.id}\\s*=\\s*([^;]+)`))||void 0===e?void 0:e.pop())&&(this.element.style.display="none")}addButton(){this.element.querySelector(".usa-alert").append(this.button)}addEventListeners(){this.button.addEventListener("click",this.eventListener)}removeEventListeners(){this.button.removeEventListener("click",this.eventListener)}handleClose(){document.cookie=`NCISiteAlert${this.element.id}=hidden; Path=${this.options.closeCookiePath}`,this.hideSiteAlert(),this.element.dispatchEvent(this.customEvents.close)}createCustomEvents(){this.customEvents.close=new CustomEvent(`${this.options.closeEventListenerLabel}:close`,{detail:this.element})}}class r{constructor(e,t){this.customEvents={},this.eventListener=()=>this.handleClick(),this.element=e,this.options=t,this.collapsibleContent=this.element.querySelector(".usa-alert__nci-content"),this.button=this.createButton(),this.initialize()}unregister(){this.collapsibleContent.classList.remove("hidden"),this.toggleCollapseA11y(),this.button.remove(),this.removeEventListeners()}initialize(){var e;this.createCustomEvents(),this.addButton(),this.addEventListeners();const t=null===(e=document.cookie.match(`(^|;)\\s*NCISiteAlert${this.element.id}\\s*=\\s*([^;]+)`))||void 0===e?void 0:e.pop();t?this.setFromCookie(t):this.toggleCollapse()}createButton(){const e=document.createElement("button");return e.classList.add("usa-alert__nci-button",this.options.collapseButtonClass),e.setAttribute("aria-controls",this.collapsibleContent.id),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-label",this.options.collapseAriaLabel),e.innerHTML='<svg class="usa-icon" role="img" aria-hidden="true" viewBox="0 0 64 39"><path fill="currentColor" d="M.655 34.187c-.427-.437-.64-.937-.64-1.503 0-.566.213-1.067.64-1.502L30.542.756c.427-.436.918-.653 1.474-.653.555 0 1.048.218 1.474.653l29.884 30.426c.428.435.642.936.642 1.502s-.213 1.066-.642 1.501l-3.206 3.265c-.427.436-.919.653-1.475.653-.555 0-1.047-.217-1.475-.653L32.016 11.79 6.81 37.45c-.427.436-.919.653-1.474.653-.556 0-1.048-.217-1.475-.653L.655 34.187z"></path></svg>',e}addButton(){this.element.querySelector(".usa-alert__nci-header").append(this.button)}toggleCollapse(){this.collapsibleContent.classList.toggle("hidden"),this.toggleCollapseA11y();const e=this.collapsibleContent.classList.contains("hidden")?"collapse":"expand";this.element.dispatchEvent(this.customEvents[e]),document.cookie=`NCISiteAlert${this.element.id}=${e}; Path=${this.options.collapseCookiePath}`}toggleCollapseA11y(){const e=this.collapsibleContent.classList.contains("hidden");this.button.setAttribute("aria-expanded",String(!e));const t=this.button.getAttribute("aria-controls");this.element.querySelector(`#${t}`).setAttribute("aria-hidden",String(e))}setFromCookie(e){"collapse"===e?this.collapsibleContent.classList.add("hidden"):"expand"===e&&this.collapsibleContent.classList.remove("hidden"),this.toggleCollapseA11y()}addEventListeners(){this.button.addEventListener("click",this.eventListener)}removeEventListeners(){this.button.removeEventListener("click",this.eventListener)}handleClick(){this.toggleCollapse()}createCustomEvents(){["collapse","expand"].forEach((e=>{this.customEvents[e]=new CustomEvent(`${this.options.collapseEventListenerLabel}:${e}`,{detail:this.element})}))}}class l{constructor(e,t){this.element=e,this.options=Object.assign(Object.assign({},l.optionDefaults),t);const i=l._components.get(this.element);i&&i.unregister(),l._components.set(this.element,this),this.initialize()}static create(e,t){if(!(e instanceof HTMLElement))throw"Element is not an HTMLElement";return this._components.get(e)||new this(e,t)}static autoInit(){document.addEventListener("DOMContentLoaded",(()=>{Array.from(document.getElementsByClassName("usa-site-alert")).forEach((e=>{var t;const i=e,s="true"===(null===(t=i.dataset.siteAlertClosable)||void 0===t?void 0:t.toLowerCase());l.create(i,{closeable:s})}))}))}unregister(){this.collapse&&this.collapse.unregister(),this.closeButton&&this.closeButton.unregister(),l._components.delete(this.element)}initialize(){this.createCloseButton(),this.createCollapse()}createCloseButton(){this.options.closeable&&this.element.id&&(this.closeButton=new o(this.element,this.options))}createCollapse(){this.element.classList.contains("usa-site-alert--nci-standard")&&this.element.id&&(this.collapse=new r(this.element,this.options))}}l.optionDefaults={closeable:!1,closeAriaLabel:"Dismiss alert",closeButtonClass:"usa-alert__nci-button--close",closeEventListenerLabel:"usa-site-alert:close-button",closeCookiePath:"/",collapseAriaLabel:"Toggle alert message",collapseButtonClass:"usa-alert__nci-button--toggle",collapseCookiePath:"/",collapseEventListenerLabel:"usa-site-alert:content"},l._components=new Map;class c{constructor(){this.useUrlForNavigationId=!0,console.warn("Mega menu source not specified")}getMegaMenuContent(){return null}}var h=window&&window.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,a){function o(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))};class u{constructor(){this.useUrlForNavigationId=!0,this.lang=document.documentElement.lang,this.primaryNavItems=Array.from(document.querySelectorAll(".nci-header-nav__primary-item a")),this.items=[{id:0,label:"Error",path:"/",langcode:this.lang,hasChildren:!1}]}getInitialMenuId(){return h(this,void 0,void 0,(function*(){return 0}))}getNavigationLevel(e){return h(this,void 0,void 0,(function*(){return this.createDefaultMobileMenu(e)}))}createDefaultMobileMenu(e){return this.items=this.primaryNavItems.map(((e,t)=>{const i=e.href;return{id:t,label:e.textContent,path:i,langcode:this.lang,hasChildren:!1}})),{id:e,label:"",path:"/",langcode:this.lang,hasChildren:!0,items:this.items,parent:null}}}class d{constructor(e){this.focusableContent=[],this.eventListener=e=>this.checkTrap(e),this.element=e,this.focusableElements="button, [href], input, select, textarea, [tabindex]:not([tabindex='-1'])"}toggleTrap(e,t){e?(this.findFocusableElements(t),t.addEventListener("keydown",this.eventListener,!0)):t.removeEventListener("keydown",this.eventListener,!0)}findFocusableElements(e){this.context=e,this.focusableContent=Array.from(e.querySelectorAll(this.focusableElements)),this.firstFocusableElement=e.querySelectorAll(this.focusableElements)[0],this.lastFocusableElement=this.focusableContent[this.focusableContent.length-1]}checkTrap(e){const t=e;("Tab"===t.key||9===parseInt(t.code,10))&&(t.shiftKey?document.activeElement===this.firstFocusableElement&&(this.lastFocusableElement.focus(),t.preventDefault()):document.activeElement===this.lastFocusableElement&&(this.firstFocusableElement.focus(),t.preventDefault()))}}var m=window&&window.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,a){function o(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))};class p{constructor(e,t){this.activeButton=null,this.activeMenu=null,this.customEvents={},this.navItems=[],this.loader=document.createElement("div"),this.loaderContainer=document.createElement("div"),this.offsetMenuClickListener=e=>this.handleOffsetMenuClick(e),this.offsetMenuKeyPressListener=e=>this.handleOffsetKeypress(e),this.element=e,this.adaptor=t,this.focusTrap=new d(this.element),this.content=document.createElement("template"),this.loader.classList.add("nci-is-loading","hidden"),this.loaderContainer.classList.add("nci-megamenu","hidden"),this.loaderContainer.ariaLive="polite",this.loaderContainer.ariaBusy="true",this.loaderContainer.ariaAtomic="true",this.loaderContainer.appendChild(this.loader),this.initialize()}unregister(){this.navItems.forEach((e=>{this.unregisterMenuItem(e)})),this.removeEventListeners(),this.loader.remove(),this.loaderContainer.remove()}unregisterMenuItem(e){(e=>"NavItemWithMM"===e.type)(e)?(e.button.removeEventListener("click",e.buttonListener),e.button.replaceWith(e.link)):(e=>"NavItemLink"===e.type)(e)&&e.link.removeEventListener("click",e.linkListener)}initialize(){const e=this.element.querySelectorAll(".nci-header-nav__primary-link");this.navItems=Array.from(e).map((e=>{const t=this.createNavButton(e);if(null===t){return{type:"NavItemLink",link:e,linkListener:this.addLinkEventListeners(e)}}return{type:"NavItemWithMM",link:e,button:t,buttonListener:this.addButtonEventListeners(t)}})),this.createCustomEvents(),this.addOffsetMenuListeners()}createNavButton(e){var t,i;if("true"===(null===(t=e.dataset.megamenuDisabled)||void 0===t?void 0:t.toLowerCase()))return null;const s=e.href;if((null==s||""===s)&&this.adaptor.useUrlForNavigationId){const t=(null!==(i=e.textContent)&&void 0!==i?i:"").trim();return console.error(`Navigation item, ${t}, does not have a data-menu-id element and adaptor is set to use ID.`),null}const n=e.dataset.menuId;if(null==n&&!this.adaptor.useUrlForNavigationId)return console.error(`Navigation item, ${s}, does not have a data-menu-id element and adaptor is set to use ID.`),null;const a=document.createElement("button");return a.innerHTML=e.innerHTML,a.classList.add("usa-button","nci-header-nav__primary-button"),a.setAttribute("aria-expanded","false"),e.classList.contains("usa-current")&&a.classList.add("usa-current"),s&&(a.setAttribute("data-href",s),a.setAttribute("aria-controls",`menu-${s.toString().replace(/[^\w\s]/gi,"")}`)),n&&(a.setAttribute("data-menu-id",n),a.setAttribute("aria-controls",`menu-${n}`)),e.replaceWith(a),a}addButtonEventListeners(e){const t=e=>m(this,void 0,void 0,(function*(){return this.handleButtonClick(e)}));return e.addEventListener("click",t),t}handleButtonClick(e){return m(this,void 0,void 0,(function*(){const t=e.target;yield this.toggleMegaMenu(t)}))}addLinkEventListeners(e){const t=e=>m(this,void 0,void 0,(function*(){return this.handleLinkClick(e)}));return e.addEventListener("click",t),t}handleLinkClick(e){var t,i;return m(this,void 0,void 0,(function*(){const s=e.currentTarget,n=(null!==(t=s.textContent)&&void 0!==t?t:"").trim();this.element.dispatchEvent(this.customEvents.linkclick({label:n,href:null!==(i=s.href)&&void 0!==i?i:"",link:s}))}))}handleOffsetMenuClick(e){if(this.activeButton&&this.activeMenu){e.composedPath().includes(this.element)||this.collapseMegaMenu()}}handleOffsetKeypress(e){if(this.activeButton&&this.activeMenu){"Escape"===e.key&&this.collapseMegaMenu()}}toggleMegaMenu(e){return m(this,void 0,void 0,(function*(){this.activeButton===e?this.collapseMegaMenu():(this.activeButton&&this.collapseMegaMenu(),yield this.expandMegaMenu(e))}))}collapseMegaMenu(){if(this.activeButton&&this.activeMenu){const e=this.getDetailsForExpandCollapse(this.activeButton);this.focusTrap.toggleTrap(!1,this.activeButton),this.activeButton.setAttribute("aria-expanded","false"),this.activeButton=null,this.activeMenu.classList.add("hidden"),this.activeMenu.setAttribute("aria-hidden","true"),this.activeMenu.remove(),this.activeMenu=null,this.element.dispatchEvent(this.customEvents.collapse(e))}}expandMegaMenu(e){return m(this,void 0,void 0,(function*(){yield this.createMenu(e),this.focusTrap.toggleTrap(!0,e),this.activeButton=e,this.activeButton.setAttribute("aria-expanded","true");const t=this.activeButton.getAttribute("aria-controls");this.activeMenu=this.element.querySelector(`#${t}`),this.activeMenu&&(this.activeMenu.classList.remove("hidden"),this.activeMenu.setAttribute("aria-hidden","false"),this.activeMenu.hidden=!1),this.element.dispatchEvent(this.customEvents.expand(this.getDetailsForExpandCollapse(this.activeButton)))}))}getDetailsForExpandCollapse(e){var t;return{label:(null!==(t=e.textContent)&&void 0!==t?t:"").trim(),id:this.getMenuIdForButton(e),button:e}}createMenu(e){return m(this,void 0,void 0,(function*(){e.after(this.loaderContainer);const t=setTimeout((()=>{this.loader.classList.remove("hidden"),this.loaderContainer.classList.remove("hidden")}),1e3),i=this.getMenuIdForButton(e),s=yield this.adaptor.getMegaMenuContent(i);s&&clearTimeout(t);const n=`menu-${i.toString().replace(/[^\w\s]/gi,"")}`;this.content=s||document.createElement("div"),this.content.setAttribute("id",n),this.content.classList.add("hidden"),this.content.ariaLive="polite",this.content.ariaBusy="false",this.content.ariaAtomic="true",this.loader.classList.add("hidden"),this.loaderContainer.classList.add("hidden"),this.loaderContainer.replaceWith(this.content),e.setAttribute("aria-controls",n)}))}getMenuIdForButton(e){var t;return null!==(t=this.adaptor.useUrlForNavigationId?e.dataset.href:e.dataset.menuId)&&void 0!==t?t:""}addOffsetMenuListeners(){document.addEventListener("click",this.offsetMenuClickListener,!1),document.addEventListener("keydown",this.offsetMenuKeyPressListener,!1)}removeEventListeners(){document.removeEventListener("click",this.handleOffsetMenuClick,!1),document.removeEventListener("keydown",this.handleOffsetKeypress,!1)}createCustomEvents(){["collapse","expand"].forEach((e=>{this.customEvents[e]=t=>new CustomEvent(`nci-header:mega-menu:${e}`,{bubbles:!0,detail:t})})),this.customEvents.linkclick=e=>new CustomEvent("nci-header:primary-nav:linkclick",{bubbles:!0,detail:e})}}var v=window&&window.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,a){function o(e){try{l(s.next(e))}catch(e){a(e)}}function r(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((s=s.apply(e,t||[])).next())}))};const b={close:{en:"Close Menu",es:"Cerrar menú"},nav:{en:"Primary navigation.",es:"Navegación primaria."}};class L{constructor(e,t){if(this.menuData=null,this.sectionParent=null,this.loader=this.createDom("div",["nci-is-loading","hidden"]),this.resizeWidth=1024,this.customEvents={},this.linkClickListener=e=>this.handleLinkClick(e),this.menuOpenEventListener=e=>this.handleOpenMenu(e),this.windowResizeEventListener=e=>{e.matches&&this.handleCloseMenu("Close")},this.menuCloseEventListener=()=>this.handleCloseMenu("Close"),this.escapeKeyPressListener=e=>v(this,void 0,void 0,(function*(){if(this.activeMenu){"Escape"===e.key&&(yield this.closeMenu("Escape"))}})),!t.getInitialMenuId)throw new Error("getInitialMenuId required to return a Promise of string or number.");if(!t.getNavigationLevel)throw new Error("getNavigationLevel required to return a Promise of MobileMenuData.");this.element=e,this.adaptor=t,this.pageUrl=window.location.pathname,this.focusTrap=new d(this.element),this.activeMenu=!1,this.mobileButton=this.element.querySelector(".nci-header-mobilenav__open-btn"),this.resizeMediaQuery=matchMedia(`(min-width: ${this.resizeWidth}px)`),this.langCode=document.documentElement.lang,this.initialize()}unregister(){this.element.removeEventListener("click",this.linkClickListener),this.mobileButton.removeEventListener("click",this.menuOpenEventListener,!0),this.mobileClose.removeEventListener("click",this.menuCloseEventListener,!0),this.mobileOverlay.removeEventListener("click",this.menuCloseEventListener,!0),document.removeEventListener("keydown",this.escapeKeyPressListener,!1),this.resizeMediaQuery.removeEventListener("change",this.windowResizeEventListener),this.mobileOverlay.remove(),this.mobileClose.remove(),this.mobileNav.remove(),this.loader.remove()}initialize(){this.mobileNav=this.createDom("div",["nci-header-mobilenav"],[{tabindex:-1},{role:"dialog"},{"aria-modal":!0},{id:"nci-header-mobilenav"}]),this.mobileNav.ariaLive="polite",this.mobileNav.ariaBusy="true",this.mobileOverlay=this.createDom("div",["nci-header-mobilenav__overlay"],[]);const e=b.close[this.langCode];this.mobileClose=this.createDom("button",["nci-header-mobilenav__close-btn"],[{"aria-controls":"nci-header-mobilenav"},{"aria-label":e}]),this.mobileClose.addEventListener("click",this.menuCloseEventListener=()=>this.handleCloseMenu("Close"),!0),this.mobileOverlay.addEventListener("click",this.menuCloseEventListener=()=>this.handleCloseMenu("Overlay"),!0),this.mobileButton.addEventListener("click",this.menuOpenEventListener,!0),this.mobileNav.append(this.mobileClose),this.mobileNav.append(this.loader),this.element.append(this.mobileNav),this.element.append(this.mobileOverlay),document.addEventListener("keydown",this.escapeKeyPressListener,!1),this.resizeMediaQuery.addEventListener("change",this.windowResizeEventListener),this.createCustomEvents()}handleOpenMenu(e){return v(this,void 0,void 0,(function*(){const t=this.element.querySelector(".nci-header-mobilenav__list");t&&t.remove(),this.mobileNav.ariaBusy="true",this.loader.classList.remove("hidden");const i=(e.currentTarget.textContent||"").trim();yield this.openMenu(i)}))}handleCloseMenu(e){this.closeMenu(e)}openMenu(e){return v(this,void 0,void 0,(function*(){this.activeMenu=!0,this.mobileNav.classList.add("active"),this.mobileOverlay.classList.toggle("active");const t=yield this.adaptor.getInitialMenuId();this.menuData=yield this.adaptor.getNavigationLevel(t);const i=this.displayNavLevel(this.menuData),s=this.createDom("nav",["nci-header-mobilenav__nav"],[{"aria-label":b.nav[this.langCode]}]);s.appendChild(i),this.mobileNav.append(s),this.mobileClose.focus(),this.focusTrap.toggleTrap(!0,this.mobileNav),this.mobileNav.ariaBusy="false",this.element.dispatchEvent(this.customEvents.open({label:e,initialMenu:this.menuData}))}))}closeMenu(e){this.activeMenu=!1,this.focusTrap.toggleTrap(!1,this.mobileNav),this.mobileNav.classList.remove("active"),this.mobileOverlay.classList.remove("active");const t=this.menuData;this.menuData=null,this.element.dispatchEvent(this.customEvents.close({action:e,lastMenu:t||null}))}handleLinkClick(e,t,i){return v(this,void 0,void 0,(function*(){const s=this.element.querySelector(".nci-header-mobilenav__list");s&&s.remove(),this.mobileNav.ariaBusy="true",this.loader.classList.remove("hidden");const n=e.target.getAttribute("data-menu-id"),a=(e.currentTarget.textContent||"").trim();if(n){this.menuData=yield this.adaptor.getNavigationLevel(n);const e=this.displayNavLevel(this.menuData);this.mobileNav.append(e),this.focusTrap.toggleTrap(!0,this.mobileNav)}this.element.dispatchEvent(this.customEvents.linkclick({action:t||null,data:this.menuData,label:a||null,index:i||null}))}))}displayNavLevel(e){const t=e.items;this.sectionParent=e.parent;const i=this.createDom("ul",["nci-header-mobilenav__list"]),s=t.map(((e,t)=>(t=this.sectionParent?t+1:t,e.hasChildren?this.makeMenuNode(e,t):this.makeMenuLink(e,t))));if(this.sectionParent){const t=this.createDom("ul",["nci-header-mobilenav__list"]),n=this.makeBackNode(this.sectionParent);i.append(n);const a=this.createDom("li",["nci-header-mobilenav__list-holder"]);a.append(t);const o=this.makeMenuLink(e,0);t.append(o),i.append(a),t.append(...s)}else i.append(...s);return this.mobileNav.ariaBusy="false",this.loader.classList.add("hidden"),i}makeBackNode(e){const t=this.adaptor.useUrlForNavigationId?e.path:e.id,i=this.createDom("li",["nci-header-mobilenav__list-node","active"],[]),s=this.createDom("button",["nci-header-mobilenav__list-msg"],[{"data-menu-id":t},{"data-href":e.path},{"data-options":0},{"data-isroot":"false"}]);return s.innerHTML=e.label,s.addEventListener("click",this.linkClickListener=e=>this.handleLinkClick(e,"Back"),!0),i.append(s),i}makeMenuNode(e,t){const i=this.adaptor.useUrlForNavigationId?e.path:e.id,s=this.createDom("li",["nci-header-mobilenav__list-node"],[]),n=this.createDom("button",["nci-header-mobilenav__list-label"],[{"data-href":e.path},{"data-menu-id":i},{"data-options":0},{"data-isroot":"false"}]);return n.innerHTML=e.label,s.addEventListener("click",this.linkClickListener=e=>this.handleLinkClick(e,"Child",t),!0),s.append(n),s}makeMenuLink(e,t){const i=this.createDom("li",["nci-header-mobilenav__list-item"],[]),s=this.createDom("a",["nci-header-mobilenav__list-link"],[{href:e.path},{"data-options":0}]);return this.pageUrl===e.path&&s.classList.add("current"),s.innerHTML=e.label,i.addEventListener("click",this.linkClickListener=e=>this.handleLinkClick(e,"Child",t),!0),i.append(s),i}createDom(e,t,i){const s=document.createElement(e);return t&&[...t].forEach((e=>{s.classList.add(e)})),i&&[...i].forEach((e=>{const t=Object.keys(e)[0],i=Object.values(e)[0];s.setAttribute(t,i)})),s}createCustomEvents(){["close","open","linkclick"].forEach((e=>{this.customEvents[e]=t=>new CustomEvent(`nci-header:mobile-menu:${e}`,{bubbles:!0,detail:t})}))}}class g{constructor(e,t,i){this.searchForm=e,this.searchInputBlurHandler=i,this.searchInputFocusHandler=t,this.searchField=this.searchForm.querySelector("#nci-header-search__field"),this.searchField&&this.initialize()}initialize(){this.searchField.addEventListener("focus",this.searchInputFocusHandler,!1),this.searchField.addEventListener("focusout",this.searchInputBlurHandler,!1)}static isSearchFormValid(){const e=document.querySelector("form.nci-header-search"),t=document.querySelector("#nci-header-search__field"),i=document.querySelector("button.nci-header-search__search-button");return!!(e&&t&&i)}unregister(){this.searchField.removeEventListener("focus",this.searchInputFocusHandler,!1),this.searchField.removeEventListener("focusout",this.searchInputBlurHandler,!1)}}class E{constructor(e,t){this.searchInputFocusHandler=e=>this.handleSearchFocus(e),this.searchInputBlurHandler=e=>this.handleSearchBlur(e),this.element=e,this.options=t,this.megaMenuNav=this.wireUpMegaMenu(),this.mobileMenu=this.wireUpMobileMenu();const i=this.element.querySelector("form.nci-header-search");i&&(this.searchForm=new g(i,this.searchInputFocusHandler,this.searchInputBlurHandler));g.isSearchFormValid()&&(this.searchDiv=this.element.querySelector(".nci-header-nav__secondary"));const s=E._components.get(this.element);s&&s.unregister(),E._components.set(this.element,this)}static create(e,t){if(!(e instanceof HTMLElement))throw"Element is not an HTMLElement";return this._components.get(e)||new this(e,t)}static autoInit(){document.addEventListener("DOMContentLoaded",(()=>{Array.from(document.getElementsByClassName("nci-header")).forEach((e=>{this.create(e,{megaMenuSource:new c,mobileMenuSource:new u})}))}))}unregister(){this.searchForm&&this.searchForm.unregister(),this.megaMenuNav.unregister(),this.mobileMenu.unregister(),E._components.delete(this.element)}wireUpMegaMenu(){const e=this.element.querySelector(".nci-header-nav__primary");return new p(e,this.options.megaMenuSource)}wireUpMobileMenu(){const e=this.element;return new L(e,this.options.mobileMenuSource)}handleSearchFocus(e){e.preventDefault(),this.searchDiv.classList.add("search-focused")}handleSearchBlur(e){e.preventDefault(),setTimeout((()=>{this.searchDiv.classList.remove("search-focused")}),250)}}E._components=new Map;export{t as NCIAutocomplete,a as NCIBigFooter,E as NCIExtendedHeaderWithMegaMenu,l as NCISiteAlert,n as NCISubscribe};
